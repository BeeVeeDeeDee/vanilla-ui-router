{"version":3,"file":null,"sources":["../core/routeParams.js","../core/dataProvider.js","../core/templates.js","../index.js"],"sourcesContent":["export const parseRouteParamToCorrectType = paramValue => {\n\tif (!isNaN(paramValue)) {\n\t\treturn parseInt(paramValue, 10);\n\t}\n\n\tif (paramValue === 'true' || paramValue === 'false') {\n\t\treturn JSON.parse(paramValue);\n\t}\n\n\treturn paramValue;\n};\n\nexport const extractRouteParams = (routeIdentifier, currentHash) => {\n\tconst splittedHash = currentHash.split('/');\n\tconst splittedRouteIdentifier = routeIdentifier.split('/');\n\n\treturn splittedRouteIdentifier.map((routeIdentifierToken, index) => {\n\t\tif (routeIdentifierToken.indexOf(':', 0) === -1) {\n\t\t\treturn null;\n\t\t}\n\t\tconst routeParam = {};\n\t\tconst key = routeIdentifierToken.substr(1, routeIdentifierToken.length - 1);\n\t\trouteParam[key] = splittedHash[index];\n\t\treturn routeParam;\n\t})\n\t.filter(p => p !== null)\n\t.reduce((acc, curr) => {\n\t\tObject.keys(curr).forEach(key => {\n\t\t\tacc[key] = parseRouteParamToCorrectType(curr[key]);\n\t\t});\n\t\treturn acc;\n\t}, {});\n};\n\nexport const findMatchingRouteIdentifier = (currentHash, routeKeys) => {\n\tconst splittedHash = currentHash.split('/');\n\tconst firstHashToken = splittedHash[0];\n\n\treturn routeKeys\n\t\t.filter(routeKey => {\n\t\t\tconst splittedRouteKey = routeKey.split('/');\n\t\t\tconst staticRouteTokensAreEqual = splittedRouteKey\n\t\t\t\t.map((routeToken, i) => {\n\t\t\t\t\tif (routeToken.indexOf(':', 0) !== -1) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn routeToken === splittedHash[i];\n\t\t\t\t})\n\t\t\t\t.reduce((countInvalid, currentValidationState) => {\n\t\t\t\t\tif (currentValidationState === false) {\n\t\t\t\t\t\t++countInvalid;\n\t\t\t\t\t}\n\t\t\t\t\treturn countInvalid;\n\t\t\t\t}, 0) === 0;\n\n\t\t\treturn routeKey.indexOf(firstHashToken, 0) !== -1 &&\n\t\t\t\t\t\t\tstaticRouteTokensAreEqual &&\n\t\t\t\t\t\t\tsplittedHash.length === splittedRouteKey.length;\n\t\t})[0];\n};\n","export const loadTemplate = (templateUrl, successCallback) => {\n\tvar xhr = new XMLHttpRequest();\n\txhr.onreadystatechange = function () {\n\t\tif (xhr.readyState === 4) {\n\t\t\tsuccessCallback(xhr.responseText);\n\t\t}\n\t};\n\txhr.open('GET', templateUrl);\n\txhr.send();\n};\n","import {loadTemplate} from './dataProvider';\n\nexport const renderTemplates = (routeConfiguration, domEntryPoint, successCallback) => {\n\tif (!routeConfiguration) {\n\t\treturn;\n\t}\n\n\tif (routeConfiguration.templateString) {\n\t\tdomEntryPoint.innerHTML = routeConfiguration.templateString;\n\t\tsuccessCallback();\n\t}\n\n\tif (routeConfiguration.templateUrl) {\n\t\tloadTemplate(routeConfiguration.templateUrl, templateString => {\n\t\t\tdomEntryPoint.innerHTML = templateString;\n\t\t\tsuccessCallback();\n\t\t});\n\t}\n\n\tif (routeConfiguration.templateId) {\n\t\tconst templateScript = document.getElementById(routeConfiguration.templateId);\n\t\tdomEntryPoint.innerHTML = templateScript.text;\n\t\tsuccessCallback();\n\t}\n};\n","import {\n\textractRouteParams,\n\tfindMatchingRouteIdentifier\n} from './core/routeParams';\nimport {renderTemplates} from './core/templates';\n\nexport const createRouter = domEntryPoint => {\n\tlet routes = {};\n\tconst lastDomEntryPoint = domEntryPoint.cloneNode(true);\n\tlet lastRouteHandler = null;\n\n\tconst navigateTo = hashUrl => {\n\t\twindow.location.hash = hashUrl;\n\t};\n\n\tconst otherwise = routeHandler => {\n\t\troutes['*'] = routeHandler;\n\t};\n\n\tconst addRoute = (hashUrl, routeHandler) => {\n\t\troutes[hashUrl] = routeHandler;\n\t\treturn {addRoute, otherwise, navigateTo};\n\t};\n\n\tconst initializeDomElement = () => {\n\t\tif (!domEntryPoint.parentElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst domClone = lastDomEntryPoint.cloneNode(true);\n\t\tdomEntryPoint.parentElement.insertBefore(domClone, domEntryPoint);\n\t\tdomEntryPoint.remove();\n\t\tdomEntryPoint = domClone;\n\t};\n\n\tconst disposeLastRoute = () => {\n\t\tif (!lastRouteHandler) return;\n\t\tif (typeof lastRouteHandler.dispose === 'undefined') return;\n\t\tlastRouteHandler.dispose(domEntryPoint);\n\t};\n\n\tconst handleRouting = () => {\n\t\tconst defaultRouteIdentifier = '*';\n\t\tconst currentHash = location.hash.slice(1);\n\n\t\tconst maybeMatchingRouteIdentifier = findMatchingRouteIdentifier(currentHash, Object.keys(routes));\n\t\tlet routeParams = {};\n\t\tif (maybeMatchingRouteIdentifier) {\n\t\t\trouteParams = extractRouteParams(maybeMatchingRouteIdentifier, currentHash);\n\t\t}\n\n\t\tconst routeHandler = Object.keys(routes).indexOf(maybeMatchingRouteIdentifier) > -1 ? routes[maybeMatchingRouteIdentifier] : routes[defaultRouteIdentifier];\n\n\t\tif (!routeHandler) {\n\t\t\treturn;\n\t\t}\n\n\t\tdisposeLastRoute(routeHandler);\n\n\t\t// Memory last routeHandler\n\t\tlastRouteHandler = routeHandler;\n\n\t\tinitializeDomElement();\n\n\t\tif (typeof routeHandler === 'function') {\n\t\t\trouteHandler(domEntryPoint, routeParams);\n\t\t} else {\n\n\t\t\trenderTemplates(routeHandler, domEntryPoint, () => {\n\t\t\t\tif (typeof routeHandler.routeHandler === 'function') {\n\t\t\t\t\trouteHandler.routeHandler(domEntryPoint, routeParams);\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t};\n\n\tif (window) {\n\t\twindow.removeEventListener('hashchange', handleRouting);\n\t\twindow.addEventListener('hashchange', handleRouting);\n\t\twindow.removeEventListener('load', handleRouting);\n\t\twindow.addEventListener('load', handleRouting);\n\t}\n\n\treturn {addRoute, otherwise, navigateTo};\n};\n"],"names":["parseRouteParamToCorrectType","isNaN","paramValue","parseInt","JSON","parse","extractRouteParams","routeIdentifier","currentHash","splittedHash","split","splittedRouteIdentifier","map","routeIdentifierToken","index","indexOf","routeParam","key","substr","length","filter","p","reduce","acc","curr","keys","forEach","findMatchingRouteIdentifier","routeKeys","firstHashToken","splittedRouteKey","routeKey","staticRouteTokensAreEqual","routeToken","i","countInvalid","currentValidationState","loadTemplate","templateUrl","successCallback","xhr","XMLHttpRequest","onreadystatechange","readyState","responseText","open","send","renderTemplates","routeConfiguration","domEntryPoint","templateString","innerHTML","templateId","templateScript","document","getElementById","text","createRouter","routes","lastDomEntryPoint","cloneNode","lastRouteHandler","navigateTo","location","hash","hashUrl","otherwise","routeHandler","addRoute","initializeDomElement","parentElement","domClone","insertBefore","remove","disposeLastRoute","dispose","handleRouting","defaultRouteIdentifier","slice","maybeMatchingRouteIdentifier","Object","routeParams","window","removeEventListener","addEventListener"],"mappings":"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"}