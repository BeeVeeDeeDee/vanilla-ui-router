{"version":3,"file":null,"sources":["../core/routeParams.js","../core/dataProvider.js","../core/templates.js","../index.js"],"sourcesContent":["export const parseRouteParamToCorrectType = paramValue => {\n\tif(!isNaN(paramValue)) {\n\t\treturn parseInt(paramValue, 10);\n\t}\n\n\tif (paramValue === 'true' || paramValue === 'false') {\n\t\treturn JSON.parse(paramValue);\n\t}\n\n\treturn paramValue;\n};\n\nexport const extractRouteParams = (routeIdentifier, currentHash) => {\n\tconst splittedHash = currentHash.split('/');\n\tconst splittedRouteIdentifier = routeIdentifier.split('/');\n\n\treturn splittedRouteIdentifier\n\t\t.map((routeIdentifierToken, index) => {\n\t\t\tif (routeIdentifierToken.indexOf(':', 0) === -1) return null;\n\t\t\t\tconst routeParam = {};\n\t\t\t\tconst key = routeIdentifierToken.substr(1, routeIdentifierToken.length - 1);\n\t\t\t\trouteParam[key] = splittedHash[index];\n\t\t\t\treturn routeParam;\n\t\t})\n\t\t.filter(p => p !== null)\n\t\t.reduce((acc, curr) => {\n\t\t\tObject.keys(curr).forEach(key => {\n\t\t\t\tacc[key] = parseRouteParamToCorrectType(curr[key]);\n\t\t\t})\n\t\t\treturn acc;\n\t\t}, {});\n};\n\nexport const findMatchingRouteIdentifier = (currentHash, routeKeys) => {\n\t  const splittedHash = currentHash.split('/');\n\t  const firstHashToken = splittedHash[0];\n\n\t  return routeKeys\n\t    .filter(routeKey => {\n\t      const splittedRouteKey = routeKey.split('/');\n\n\t      const staticRouteTokensAreEqual = splittedRouteKey\n\t        .map((routeToken, i) => {\n\t          if(routeToken.indexOf(':', 0) !== -1) return true;\n\t          return routeToken === splittedHash[i];\n\t        })\n\t        .reduce((countInvalid, currentValidationState) => {\n\t          if (currentValidationState === false) {\n\t            ++countInvalid;\n\t          }\n\t          return countInvalid;\n\t        }, 0) === 0;\n\n\t      return routeKey.indexOf(firstHashToken, 0) !== -1 &&\n\t             staticRouteTokensAreEqual &&\n\t             splittedHash.length === splittedRouteKey.length;\n\t    })[0];\n\t};\n","export const loadTemplate = (templateUrl, successCallback) => {\n\tvar xhr = new XMLHttpRequest();\n\txhr.onreadystatechange = function () {\n\t\tif (xhr.readyState === 4) {\n\t\t\tsuccessCallback(xhr.responseText);\n\t\t}\n\t};\n\txhr.open('GET', templateUrl);\n\txhr.send();\n};\n","import { loadTemplate } from './dataProvider';\n\nexport const renderTemplates = (routeConfiguration, domEntryPoint) => {\n\tif (!routeConfiguration) return;\n\n\tif (routeConfiguration.templateString) {\n\t\tdomEntryPoint.innerHTML = routeConfiguration.templateString;\n\t}\n\n\tif (routeConfiguration.templateUrl) {\n\t\tloadTemplate(routeConfiguration.templateUrl, templateString => {\n\t\t\tdomEntryPoint.innerHTML = templateString;\n\t\t});\n\t}\n\n\tif (routeConfiguration.templateId) {\n\t\tconst templateScript = document.getElementById(routeConfiguration.templateId);\n\t\tdomEntryPoint.innerHTML = templateScript.text;\n\t}\n};\n","import {\n\tparseRouteParamToCorrectType,\n\textractRouteParams,\n\tfindMatchingRouteIdentifier\n} from './core/routeParams';\nimport { renderTemplates } from './core/templates';\n\nexport const createRouter = domEntryPoint => {\n\tlet routes = {};\n\n\tconst getRouterObject = () => {\n\t\treturn { addRoute, otherwise, navigateTo };\n\t}\n\n\tconst addRoute = (hashUrl, routeHandler) => {\n\t\troutes[hashUrl] = routeHandler;\n\t\treturn getRouterObject();\n\t};\n\n\tconst navigateTo = hashUrl => {\n\t\twindow.location.hash = hashUrl;\n\t};\n\n\tconst otherwise = routeHandler => {\n\t\troutes['*'] = routeHandler;\n\t};\n\n\tconst handleRouting = () => {\n\t\tconst defaultRouteIdentifier = '*';\n\t\tconst currentHash = location.hash.slice(1);\n\n\t\tconst maybeMatchingRouteIdentifier = findMatchingRouteIdentifier(currentHash, Object.keys(routes));\n\t  let routeParams = {};\n\t\tif (maybeMatchingRouteIdentifier) {\n\t\t\trouteParams = extractRouteParams(maybeMatchingRouteIdentifier, currentHash);\n\t\t}\n\n\t\tconst routeHandler = Object.keys(routes).indexOf(maybeMatchingRouteIdentifier) !== -1 ? routes[maybeMatchingRouteIdentifier] : routes[defaultRouteIdentifier];\n\n\t\tif (!routeHandler) return;\n\n\t\tif (typeof routeHandler === 'function') {\n\t\t\trouteHandler(domEntryPoint, routeParams);\n\t\t} else {\n\n\t\t\trenderTemplates(routeHandler, domEntryPoint);\n\n\t\t\tif(typeof routeHandler.routeHandler === 'function') {\n\t\t\t\trouteHandler.routeHandler(domEntryPoint, routeParams);\n\t\t\t}\n\t\t}\n\t};\n\n\tif (window) {\n\t\twindow.removeEventListener('hashchange', handleRouting);\n\t\twindow.addEventListener('hashchange', handleRouting);\n\t\twindow.removeEventListener('load', handleRouting);\n\t\twindow.addEventListener('load', handleRouting);\n\t}\n\n\treturn getRouterObject();\n};\n"],"names":["parseRouteParamToCorrectType","isNaN","paramValue","parseInt","JSON","parse","extractRouteParams","routeIdentifier","currentHash","splittedHash","split","splittedRouteIdentifier","map","routeIdentifierToken","index","indexOf","routeParam","key","substr","length","filter","p","reduce","acc","curr","keys","forEach","findMatchingRouteIdentifier","routeKeys","firstHashToken","splittedRouteKey","routeKey","staticRouteTokensAreEqual","routeToken","i","countInvalid","currentValidationState","loadTemplate","templateUrl","successCallback","xhr","XMLHttpRequest","onreadystatechange","readyState","responseText","open","send","renderTemplates","routeConfiguration","domEntryPoint","templateString","innerHTML","templateId","templateScript","document","getElementById","text","createRouter","routes","getRouterObject","addRoute","otherwise","navigateTo","hashUrl","routeHandler","location","hash","handleRouting","defaultRouteIdentifier","slice","maybeMatchingRouteIdentifier","Object","routeParams","window","removeEventListener","addEventListener"],"mappings":";;;;;;AAAO,IAAMA,+BAA+B,SAA/BA,4BAA+B,aAAc;KACtD,CAACC,MAAMC,UAAN,CAAJ,EAAuB;SACfC,SAASD,UAAT,EAAqB,EAArB,CAAP;;;KAGGA,eAAe,MAAf,IAAyBA,eAAe,OAA5C,EAAqD;SAC7CE,KAAKC,KAAL,CAAWH,UAAX,CAAP;;;QAGMA,UAAP;CATM;;AAYP,AAAO,IAAMI,qBAAqB,SAArBA,kBAAqB,CAACC,eAAD,EAAkBC,WAAlB,EAAkC;KAC7DC,eAAeD,YAAYE,KAAZ,CAAkB,GAAlB,CAArB;KACMC,0BAA0BJ,gBAAgBG,KAAhB,CAAsB,GAAtB,CAAhC;;QAEOC,wBACLC,GADK,CACD,UAACC,oBAAD,EAAuBC,KAAvB,EAAiC;MACjCD,qBAAqBE,OAArB,CAA6B,GAA7B,EAAkC,CAAlC,MAAyC,CAAC,CAA9C,EAAiD,OAAO,IAAP;MAC1CC,aAAa,EAAnB;MACMC,MAAMJ,qBAAqBK,MAArB,CAA4B,CAA5B,EAA+BL,qBAAqBM,MAArB,GAA8B,CAA7D,CAAZ;aACWF,GAAX,IAAkBR,aAAaK,KAAb,CAAlB;SACOE,UAAP;EANI,EAQLI,MARK,CAQE;SAAKC,MAAM,IAAX;EARF,EASLC,MATK,CASE,UAACC,GAAD,EAAMC,IAAN,EAAe;SACfC,IAAP,CAAYD,IAAZ,EAAkBE,OAAlB,CAA0B,eAAO;OAC5BT,GAAJ,IAAWjB,6BAA6BwB,KAAKP,GAAL,CAA7B,CAAX;GADD;SAGOM,GAAP;EAbK,EAcH,EAdG,CAAP;CAJM;;AAqBP,AAAO,IAAMI,8BAA8B,SAA9BA,2BAA8B,CAACnB,WAAD,EAAcoB,SAAd,EAA4B;KAC9DnB,eAAeD,YAAYE,KAAZ,CAAkB,GAAlB,CAArB;KACMmB,iBAAiBpB,aAAa,CAAb,CAAvB;;QAEOmB,UACJR,MADI,CACG,oBAAY;MACZU,mBAAmBC,SAASrB,KAAT,CAAe,GAAf,CAAzB;;MAEMsB,4BAA4BF,iBAC/BlB,GAD+B,CAC3B,UAACqB,UAAD,EAAaC,CAAb,EAAmB;OACnBD,WAAWlB,OAAX,CAAmB,GAAnB,EAAwB,CAAxB,MAA+B,CAAC,CAAnC,EAAsC,OAAO,IAAP;UAC/BkB,eAAexB,aAAayB,CAAb,CAAtB;GAH8B,EAK/BZ,MAL+B,CAKxB,UAACa,YAAD,EAAeC,sBAAf,EAA0C;OAC5CA,2BAA2B,KAA/B,EAAsC;MAClCD,YAAF;;UAEKA,YAAP;GAT8B,EAU7B,CAV6B,MAUtB,CAVZ;;SAYOJ,SAAShB,OAAT,CAAiBc,cAAjB,EAAiC,CAAjC,MAAwC,CAAC,CAAzC,IACAG,yBADA,IAEAvB,aAAaU,MAAb,KAAwBW,iBAAiBX,MAFhD;EAhBG,EAmBF,CAnBE,CAAP;CAJI;;ACjCA,IAAMkB,eAAe,SAAfA,YAAe,CAACC,WAAD,EAAcC,eAAd,EAAkC;KACzDC,MAAM,IAAIC,cAAJ,EAAV;KACIC,kBAAJ,GAAyB,YAAY;MAChCF,IAAIG,UAAJ,KAAmB,CAAvB,EAA0B;mBACTH,IAAII,YAApB;;EAFF;KAKIC,IAAJ,CAAS,KAAT,EAAgBP,WAAhB;KACIQ,IAAJ;CARM;;ACEA,IAAMC,kBAAkB,SAAlBA,eAAkB,CAACC,kBAAD,EAAqBC,aAArB,EAAuC;KACjE,CAACD,kBAAL,EAAyB;;KAErBA,mBAAmBE,cAAvB,EAAuC;gBACxBC,SAAd,GAA0BH,mBAAmBE,cAA7C;;;KAGGF,mBAAmBV,WAAvB,EAAoC;eACtBU,mBAAmBV,WAAhC,EAA6C,0BAAkB;iBAChDa,SAAd,GAA0BD,cAA1B;GADD;;;KAKGF,mBAAmBI,UAAvB,EAAmC;MAC5BC,iBAAiBC,SAASC,cAAT,CAAwBP,mBAAmBI,UAA3C,CAAvB;gBACcD,SAAd,GAA0BE,eAAeG,IAAzC;;CAfK;;ACKA,IAAMC,eAAe,SAAfA,YAAe,gBAAiB;KACxCC,SAAS,EAAb;;KAEMC,kBAAkB,SAAlBA,eAAkB,GAAM;SACtB,EAAEC,kBAAF,EAAYC,oBAAZ,EAAuBC,sBAAvB,EAAP;EADD;;KAIMF,WAAW,SAAXA,QAAW,CAACG,OAAD,EAAUC,YAAV,EAA2B;SACpCD,OAAP,IAAkBC,YAAlB;SACOL,iBAAP;EAFD;;KAKMG,aAAa,SAAbA,UAAa,UAAW;SACtBG,QAAP,CAAgBC,IAAhB,GAAuBH,OAAvB;EADD;;KAIMF,YAAY,SAAZA,SAAY,eAAgB;SAC1B,GAAP,IAAcG,YAAd;EADD;;KAIMG,gBAAgB,SAAhBA,aAAgB,GAAM;MACrBC,yBAAyB,GAA/B;MACM5D,cAAcyD,SAASC,IAAT,CAAcG,KAAd,CAAoB,CAApB,CAApB;;MAEMC,+BAA+B3C,4BAA4BnB,WAA5B,EAAyC+D,OAAO9C,IAAP,CAAYiC,MAAZ,CAAzC,CAArC;MACKc,cAAc,EAAlB;MACGF,4BAAJ,EAAkC;iBACnBhE,mBAAmBgE,4BAAnB,EAAiD9D,WAAjD,CAAd;;;MAGKwD,eAAeO,OAAO9C,IAAP,CAAYiC,MAAZ,EAAoB3C,OAApB,CAA4BuD,4BAA5B,MAA8D,CAAC,CAA/D,GAAmEZ,OAAOY,4BAAP,CAAnE,GAA0GZ,OAAOU,sBAAP,CAA/H;;MAEI,CAACJ,YAAL,EAAmB;;MAEf,OAAOA,YAAP,KAAwB,UAA5B,EAAwC;gBAC1Bf,aAAb,EAA4BuB,WAA5B;GADD,MAEO;;mBAEUR,YAAhB,EAA8Bf,aAA9B;;OAEG,OAAOe,aAAaA,YAApB,KAAqC,UAAxC,EAAoD;iBACtCA,YAAb,CAA0Bf,aAA1B,EAAyCuB,WAAzC;;;EArBH;;KA0BIC,MAAJ,EAAY;SACJC,mBAAP,CAA2B,YAA3B,EAAyCP,aAAzC;SACOQ,gBAAP,CAAwB,YAAxB,EAAsCR,aAAtC;SACOO,mBAAP,CAA2B,MAA3B,EAAmCP,aAAnC;SACOQ,gBAAP,CAAwB,MAAxB,EAAgCR,aAAhC;;;QAGMR,iBAAP;CArDM;;;;;;"}